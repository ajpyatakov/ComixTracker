<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:pf="http://jsf.playerfinder.net/components">
    
    
    <h:head>
        <title>Comics catalogue</title>
        <h:outputStylesheet library="css" name="style.css" />
    </h:head>
    <h:body>
        <h:form id="form">
            <p:dataTable    
                id="comicsTable"
                var="comics"
                widgetVar="comicsTable"
                value="#{comicsCatalogueView.lazyModel}" 
                paginator="true" 
                rows="3"
                paginatorTemplate="{RowsPerPageDropdown} {FirstPageLink} {PreviousPageLink} 
                    {CurrentPageReport} {NextPageLink} {LastPageLink}"
                rowsPerPageTemplate="3,6,9" 
                selectionMode="single" 
                selection="#{comicsCatalogueView.selectedComics}"
                emptyMessage="No comics found!"
                lazy="true">
                
                <p:ajax 
                    event="rowSelect" 
                    listener="#{comicsCatalogueView.onRowSelect}"
                    update=":form:comicsDetail" 
                    oncomplete="PF('comicsDialog').show()"/> 
                
                <p:column headerText="Name" sortBy="#{comics.name}" 
                          filterBy="#{comics.name}" filterMatchMode="lte">
                    <h:outputText value="#{comics.name}" />
                </p:column>      
                
                <p:column headerText="Rating" sortBy="#{comics.rating}" 
                          filterBy="#{comics.rating}" filterMatchMode="exact" >
                    <!--                        how to include class="rating_img"-->
                    <f:facet name="filter" >
                        <p:selectOneMenu onchange="PF('comicsTable').filter()" 
                                         >
                            <f:selectItem itemLabel="All ratings" itemValue="#{null}" 
                                          noSelectionOption="true"/> 
                            <f:selectItems value="#{comicsCatalogueView.ratings}" 
                                         />
                        </p:selectOneMenu>
                    </f:facet>
                 
                <h:panelGroup>
                    <pf:rating  disabled="true"
                                totalStars="5"
                                step="0.1"
                                value="#{comics.rating}"
                                >
                    </pf:rating>
                    <h:outputText value="Rating: "
                        style="padding-left: 10px;" />
                    <h:outputText value="#{comics.rating}" />
                </h:panelGroup>
                    
                </p:column>
                <p:column headerText="Image" >
                    <p:graphicImage name="images/comics/#{comics.image}"
                                         width="100px"
                                         height="100px"/> 
                </p:column>
                <p:column headerText="Description">
                    <h:outputText value="#{comics.description}"/>
                </p:column>
            </p:dataTable>
 
            <p:dialog header="Comics Detail" 
                      widgetVar="comicsDialog" 
                      modal="true" 
                      showEffect="fade" 
                      hideEffect="fade" 
                      resizable="false" >
                <p:outputPanel id="comicsDetail" style="text-align:center;">
                    <p:panelGrid  columns="2" 
                                  rendered="#{not empty comicsCatalogueView.selectedComics}" 
                                  columnClasses="label,value">
                    <f:facet name="header">
                        <p:graphicImage name="/images/comics/#{comicsCatalogueView.selectedComics.image}"
                                         width="200px"
                                         height="200px"/> 
                    </f:facet>
                    <f:facet name="footer">
                        <h:outputLink value="comics.xhtml">
                            Visit comics page</h:outputLink>
                    </f:facet>
 
                    <h:outputText value="Id:" />
                    <h:outputText value="#{comicsCatalogueView.selectedComics.id}" />
 
                    <h:outputText value="Name" />
                    <h:outputText value="#{comicsCatalogueView.selectedComics.name}" />
 
                    <h:outputText value="Rating:" />
                    <pf:rating value="#{comicsCatalogueView.selectedComics.rating}" 
                               disabled="true" totalStars="5"
                               step="0.1"/>
 
                    <h:outputText value="Description:" />
                    <h:outputText value="#{comicsCatalogueView.selectedComics.description}"/>
                        
                    </p:panelGrid>
                </p:outputPanel>
            </p:dialog>
        </h:form>
    </h:body>
</html>
