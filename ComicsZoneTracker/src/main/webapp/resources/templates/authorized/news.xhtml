<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/resources/templates/authorized/authorized.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://java.sun.com/jsf/core">
    <ui:define name="articleContent">
        <h:form id="news">
            <p:tabView>
            <p:tab
                title="Comments">
            <p:dataScroller
                chunkSize="10"
                value="#{userNewsManagedBean.newContainers}"
                rowIndexVar="index"
                var="container">
                <p:panel 
                    header="New comments"
                    style=" width:75%; margin-left: auto; margin-right: auto; margin-bottom: 2em;">
                    <h:outputText
                        value="New comments on #{container.contentType} "/>
                    <p:link
                        value="#{container.name}"
                        outcome="#{userNewsManagedBean.redirect(container)}"/>
                    <br/>
                    <h:outputText
                        value="Comments left after your last comment: 
                        #{userNewsManagedBean.getNumberOfNewComments(index)}"/>
                    <br/>
                    <h:outputText
                        value="Comments you haven't read: 
                        #{userNewsManagedBean.getNumberOfUnreadComments(index)}"/>
                    <br/>
                    <h:outputText
                        value="You haven't commented it 
                        #{userNewsManagedBean.getPeriodFromUser(index)}."/>
                    <br/>
                    <h:outputText
                        value="Last comment to it was 
                        #{userNewsManagedBean.getPeriodFromLastComment(index)} ago."/>
                    <br/>
                    <p:commandButton
                        value="#{userNewsManagedBean.getValueOfViewButton(index)}"
                        update=":news"
                        action="#{userNewsManagedBean.resetShowingComments(index)}"/>
                    <p:dataGrid
                        rendered="#{userNewsManagedBean.areCommentsShowing(index)}"
                        var="newComment"
                        value="#{userNewsManagedBean.getNewComments(index)}"
                        emptyMessage="No comments"
                        columns="1"
                        rows = "5"
                        paginator="true"
                        paginatorTemplate="{CurrentPageReport} {PageLinks}">
                        <p:panel 
                            header="#{newComment.userId.nickname}"
                            style="text-align: left;">
                            <h:outputText
                              value="#{newComment.text}"
                              style=" white-space: pre-wrap; "/>
                        </p:panel>
                    </p:dataGrid>
                </p:panel>
            </p:dataScroller>
            </p:tab>
            
            <p:tab
                title="Friend requests"
                id="req">
            <p:dataScroller
                chunkSize="10"
                var="request"
                rowIndexVar="index"
                value="">
                <p:panel
                    header="Friend request"
                    style="text-align: left;">
                    <h:outputText
                        value="User 
                        wants to add you as a friend."/>
                    <p:commandButton
                        update=":news"
                        value="Add to friends"/>
                    <p:commandButton
                        update=":news"
                        value="Decline request"/>
                </p:panel>
            </p:dataScroller>
            </p:tab>
            </p:tabView>
        </h:form>
    </ui:define>
</ui:composition>
