<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:p="http://primefaces.org/ui" 
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:pf="http://jsf.playerfinder.net/components"
      xmlns:c="http://java.sun.com/jsp/jstl/core">
    <h:head>
        <h:outputScript library="scripts" name="PopUpWindowScript.js"/>
    </h:head>
    <h:body>
        
        <ui:composition template="/resources/templates/unauthorized/unauthorized.xhtml">
    <ui:define name="articleContent">
        <f:metadata>
            <f:viewParam name="id" value="#{comicsController.comicsId}"/>
        </f:metadata>
        #{comicsController.initComics()}
        <center>
            <p:panelGrid style="width:65%;">
                <f:facet name="header" >
                    <p:row>
                        <p:column colspan="2">
                            #{comicsController.comics.name}
                        </p:column>
                    </p:row>
                </f:facet>
                <p:row>
                    <p:column colspan="1" style="width: 45%; height:auto;">
                        <p:graphicImage value="#{comicsController.comics.image}"
                                        styleClass="content-image"
                                        height="100%"
                                        width="100%"/>
                    </p:column>
                    <p:column colspan="1" style="text-align: left; vertical-align: text-top;">
                       <h:outputText value="Publisher: #{comicsController.comics.publisherId.name}"/>
                       <br/>
                       <h:outputText value="Imprint: #{comicsController.comics.imprintId.name}"/>
                        <br/>
                       <h:outputText value="Description: #{comicsController.comics.description}"/>
                    </p:column>
                </p:row>
                <p:row>
                    <p:column colspan="2">
                            <c:choose>
                                <c:when test="#{userRoleManagedBean.isUserAuthorized()}">
                                    <pf:rating value="#{comicsController.comics.rating}"
                                        totalStars="5"
                                        step="1">
                                    </pf:rating>
                                </c:when>
                                <c:otherwise>
                                    <h:link onclick="showPopUpWin('RegistrationWindow')"
                                                   value="Join"/>
                                    or 
                                    <h:link onclick="showPopUpWin('LoginWindow')"
                                                   value="Sign In"/>
                                    to rate and read comics!
                                </c:otherwise>
                            </c:choose>
                    </p:column>
                </p:row>
            </p:panelGrid>    
            <p:accordionPanel var="volume" value="#{comicsController.comics.volumeList}">
                            <p:tab title="#{volume.name}">
                                <p:dataGrid var="issue"
                                            value="#{volume.issueList}"
                                            columns="6"
                                            layout="grid"
                                            paginator="true"
                                            rows="7"                                           lazy="true">
                        <p:panelGrid columns="1" columnClasses="label,value">
                        <p:row>
                        <p:graphicImage value="#{issue.image}"
                                        styleClass="content-image"
                                        />
                        </p:row>
                        <p:row>
                            <p:link value="#{issue.name}" 
                                    outcome="#{comicsController.redirect(issue.id)}" 
                                    style="height:auto; width:60%;"/>
                        </p:row>
                    </p:panelGrid>
                </p:dataGrid>
                            </p:tab>
            </p:accordionPanel>
        </center>
    </ui:define>
</ui:composition>
</h:body>
</html>
